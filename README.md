# ЁЯдЦ р╕Щр╣Йр╕нр╕Зр╕Ър╕нр╕Ч - Line Chatbot with OpenAI

р╕Щр╣Йр╕нр╕Зр╕Ър╕нр╕Чр╣Ар╕Ыр╣Зр╕Щ Chatbot р╕Чр╕╡р╣Ир╕Щр╣Ир╕▓р╕гр╕▒р╕Бр╕Щр╣Ир╕▓р╣Ар╕нр╣Зр╕Щр╕Фр╕╣р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Кр╣Ир╕зр╕вр╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щр╣Гр╕Щ office р╕Др╣Йр╕Щр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕┤р╕Щр╕Др╣Йр╕▓р╣Бр╕ер╕░р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕Вр╕нр╕Зр╕Ър╕гр╕┤р╕йр╕▒р╕Ч р╣Вр╕Фр╕вр╣Гр╕Кр╣Й Line OA р╣Ар╕Кр╕╖р╣Ир╕нр╕бр╕Хр╣Ир╕нр╕Бр╕▒р╕Ъ OpenAI р╣Бр╕ер╕░р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М Excel

## тЬи р╕Др╕╕р╕Ур╕кр╕бр╕Ър╕▒р╕Хр╕┤

- ЁЯФН р╕Др╣Йр╕Щр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕┤р╕Щр╕Др╣Йр╕▓/р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М Excel
- ЁЯдЦ р╣Гр╕Кр╣Й OpenAI GPT-4 р╣Гр╕Щр╕Бр╕▓р╕гр╕Хр╕нр╕Ър╕Др╕│р╕Цр╕▓р╕б
- ЁЯТм р╕Ър╕╕р╕Др╕ер╕┤р╕Бр╕ар╕▓р╕Юр╕Щр╣Ир╕▓р╕гр╕▒р╕Бр╕Щр╣Ир╕▓р╣Ар╕нр╣Зр╕Щр╕Фр╕╣
- ЁЯУ▒ р╕гр╕нр╕Зр╕гр╕▒р╕Ъ Line Official Account
- ЁЯЫбя╕П р╕Хр╕нр╕Ър╣Ар╕Йр╕Юр╕▓р╕░р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щр╕гр╕░р╕Ър╕Ър╣Ар╕Чр╣Ир╕▓р╕Щр╕▒р╣Йр╕Щ
- ЁЯФТ р╣Др╕бр╣Ир╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕вр╕гр╕лр╕▒р╕кр╕ар╕▓р╕вр╣Гр╕Щр╕Вр╕нр╕Зр╕кр╕┤р╕Щр╕Др╣Йр╕▓

## ЁЯУК р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Чр╕╡р╣Ир╕гр╕нр╕Зр╕гр╕▒р╕Ъ

р╕гр╕░р╕Ър╕Ър╕кр╕▓р╕бр╕▓р╕гр╕Цр╕Др╣Йр╕Щр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕ер╕Ир╕▓р╕Бр╣Др╕Яр╕ер╣М Excel р╕Хр╕▓р╕бр╕Др╕нр╕ер╕▒р╕бр╕Щр╣Мр╕Хр╣Ир╕нр╣Др╕Ыр╕Щр╕╡р╣Й:

- **р╕гр╕лр╕▒р╕кр╕кр╕┤р╕Щр╕Др╣Йр╕▓** (Column B)
- **р╕Кр╕╖р╣Ир╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓/р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕н** (р╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в/р╕нр╕▒р╕Зр╕Бр╕др╕й, р╣Бр╕Ър╕Ър╕вр╕▓р╕з/р╕кр╕▒р╣Йр╕Щ)
- **р╕Бр╕ер╕╕р╣Ир╕бр╕кр╕▓р╕гр╕░р╕Бр╕▓р╕гр╣Ар╕гр╕╡р╕вр╕Щр╕гр╕╣р╣Й** (р╕ар╕▓р╕йр╕▓р╣Др╕Чр╕в/р╕нр╕▒р╕Зр╕Бр╕др╕й)
- **р╕Др╕│р╕Щр╕│р╕лр╕Щр╣Йр╕▓р╕Кр╕╖р╣Ир╕нр╕кр╕┤р╕Щр╕Др╣Йр╕▓/р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕н**
- **р╕Ыр╕гр╕░р╣Ар╕ар╕Чр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕н**
- **р╕Кр╕▒р╣Йр╕Щр╕Ыр╕╡**
- **р╕кр╕Цр╕▓р╕Щр╕░р╕кр╕┤р╕Щр╕Др╣Йр╕▓р╣Гр╕лр╕бр╣И**
- **р╕бр╕╡ E-book р╕лр╕гр╕╖р╕нр╣Др╕бр╣И**
- **URL р╕гр╕╣р╕Ыр╕ар╕▓р╕Ю**

## ЁЯЪА р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕Зр╣Бр╕ер╕░р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

### Local Development

#### 1. р╕Хр╕┤р╕Фр╕Хр╕▒р╣Йр╕З Dependencies

```bash
npm install
```

#### 2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Environment Variables

р╕кр╕гр╣Йр╕▓р╕Зр╣Др╕Яр╕ер╣М `.env` р╕Ир╕▓р╕Б `.env.example`:

```bash
copy .env.example .env   # Windows
# р╕лр╕гр╕╖р╕н
cp .env.example .env     # Mac/Linux
```

р╣Бр╕Бр╣Йр╣Др╕Вр╣Др╕Яр╕ер╣М `.env`:

```env
# Line Bot Configuration
LINE_CHANNEL_ACCESS_TOKEN=your_line_channel_access_token_here
LINE_CHANNEL_SECRET=your_line_channel_secret_here

# OpenAI Configuration
OPENAI_API_KEY=your_openai_api_key_here

# Server Configuration
PORT=3000
```

### 3. р╣Ар╕Хр╕гр╕╡р╕вр╕бр╣Др╕Яр╕ер╣Мр╕Вр╣Йр╕нр╕бр╕╣р╕е

р╕зр╕▓р╕Зр╣Др╕Яр╕ер╣М `item-asset.xlsx` р╣Гр╕Щр╣Вр╕Яр╕ер╣Ар╕Фр╕нр╕гр╣Мр╕лр╕ер╕▒р╕Бр╕Вр╕нр╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д

#### 4. р╣Ар╕гр╕┤р╣Ир╕бр╕Хр╣Йр╕Щр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ (Local)

```bash
# р╕кр╕│р╕лр╕гр╕▒р╕Ъ Development
npm run dev

# р╕лр╕гр╕╖р╕нр╕кр╕│р╕лр╕гр╕▒р╕Ъ Production testing
npm start
```

### Production Deployment

р╕кр╕│р╕лр╕гр╕▒р╕Ъ Deploy р╕Ър╕Щ Render, р╕Фр╕╣р╕Др╕│р╣Бр╕Щр╕░р╕Щр╕│р╣Гр╕Щ [DEPLOYMENT.md](DEPLOYMENT.md)

#### Quick Deploy Steps:
1. Push code р╣Др╕Ы GitHub
2. Connect р╕Бр╕▒р╕Ъ Render
3. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Environment Variables
4. Deploy!

```bash
# Deploy script (р╕кр╕│р╕лр╕гр╕▒р╕Ъ Linux/Mac)
chmod +x deploy.sh
./deploy.sh
```

## ЁЯФз API Endpoints

### Webhook р╕кр╕│р╕лр╕гр╕▒р╕Ъ Line
```
POST /webhook
```

### Health Check
```
GET /health
```

### р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Др╣Йр╕Щр╕лр╕▓
```
GET /search/:query
```

### р╕Чр╕Фр╕кр╕нр╕Ъ OpenAI Response
```
POST /test-ai
Content-Type: application/json
{
  "message": "р╕Др╕│р╕Цр╕▓р╕бр╕Чр╕╡р╣Ир╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕гр╕Чр╕Фр╕кр╕нр╕Ъ"
}
```

## ЁЯУ▒ р╕Бр╕▓р╕гр╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Line Official Account

### 1. р╕кр╕гр╣Йр╕▓р╕З Line Official Account
1. р╣Др╕Ыр╕Чр╕╡р╣И [Line Developers Console](https://developers.line.biz/)
2. р╕кр╕гр╣Йр╕▓р╕З Provider р╣Бр╕ер╕░ Channel р╣Гр╕лр╕бр╣И
3. р╣Ар╕ер╕╖р╕нр╕Б "Messaging API"

### 2. р╕Хр╕▒р╣Йр╕Зр╕Др╣Ир╕▓ Webhook
1. р╣Гр╕Щр╕лр╕Щр╣Йр╕▓ Channel settings
2. р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ "Use webhook"
3. р╣Гр╕кр╣И URL: `https://your-domain.com/webhook`
4. р╣Ар╕Ыр╕┤р╕Фр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ "Allow bot to join group chats" (р╕Цр╣Йр╕▓р╕Хр╣Йр╕нр╕Зр╕Бр╕▓р╕г)

### 3. р╕гр╕▒р╕Ъ Access Token р╣Бр╕ер╕░ Channel Secret
1. Channel Access Token: р╣Гр╕Щ "Messaging API" tab
2. Channel Secret: р╣Гр╕Щ "Basic settings" tab

## ЁЯдЦ р╕зр╕┤р╕Шр╕╡р╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ Chatbot

### р╕Др╕│р╕кр╕▒р╣Ир╕Зр╕Юр╕╖р╣Йр╕Щр╕Рр╕▓р╕Щ
- **р╕Чр╕▒р╕Бр╕Чр╕▓р╕в**: "р╕кр╕зр╕▒р╕кр╕Фр╕╡", "hello", "hi"
- **р╕Др╣Йр╕Щр╕лр╕▓р╕кр╕┤р╕Щр╕Др╣Йр╕▓**: "р╕бр╕╡р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕Др╕Ур╕┤р╕Хр╕ир╕▓р╕кр╕Хр╕гр╣Мр╣Др╕лр╕б"
- **р╕Др╣Йр╕Щр╕лр╕▓р╕Хр╕▓р╕бр╕Кр╕▒р╣Йр╕Щр╕Ыр╕╡**: "р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕Кр╕▒р╣Йр╕Щ р╕Ы.1"
- **р╕Др╣Йр╕Щр╕лр╕▓р╕кр╕┤р╕Щр╕Др╣Йр╕▓р╣Гр╕лр╕бр╣И**: "р╕кр╕┤р╕Щр╕Др╣Йр╕▓р╣Гр╕лр╕бр╣Ир╕бр╕╡р╕нр╕░р╣Др╕гр╕Ър╣Йр╕▓р╕З"

### р╕Хр╕▒р╕зр╕нр╕вр╣Ир╕▓р╕Зр╕Бр╕▓р╕гр╣Гр╕Кр╣Йр╕Зр╕▓р╕Щ

**р╕Ьр╕╣р╣Йр╣Гр╕Кр╣Й**: "р╕бр╕╡р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕ар╕▓р╕йр╕▓р╕нр╕▒р╕Зр╕Бр╕др╕йр╕Кр╕▒р╣Йр╕Щ р╕б.1 р╣Др╕лр╕б"

**р╕Щр╣Йр╕нр╕Зр╕Ър╕нр╕Ч**: "р╕бр╕╡р╕Др╣Ир╕░р╕Юр╕╡р╣И! р╕Щр╣Йр╕нр╕Зр╣Ар╕Ир╕нр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╕ар╕▓р╕йр╕▓р╕нр╕▒р╕Зр╕Бр╕др╕йр╕Кр╕▒р╣Йр╕Щ р╕б.1 р╣Гр╕лр╣Йр╕Юр╕╡р╣Ир╣Ар╕ер╕вр╕Др╣Ир╕░ ЁЯУЪ

р╕гр╕лр╕▒р╕кр╕кр╕┤р╕Щр╕Др╣Йр╕▓: EN101
р╕Кр╕╖р╣Ир╕нр╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕н: English for Communication р╕б.1
р╕Бр╕ер╕╕р╣Ир╕бр╕кр╕▓р╕гр╕░: р╕ар╕▓р╕йр╕▓р╕Хр╣Ир╕▓р╕Зр╕Ыр╕гр╕░р╣Ар╕Чр╕и
р╕Ыр╕гр╕░р╣Ар╕ар╕Ч: р╕лр╕Щр╕▒р╕Зр╕кр╕╖р╕нр╣Ар╕гр╕╡р╕вр╕Щ
р╕бр╕╡ E-book: р╣Гр╕Кр╣И

р╕бр╕╡р╕нр╕░р╣Др╕гр╕нр╕╖р╣Ир╕Щр╣Гр╕лр╣Йр╕Щр╣Йр╕нр╕Зр╕Кр╣Ир╕зр╕вр╣Др╕лр╕бр╕Др╕░? ЁЯШК"

## ЁЯЫая╕П р╣Вр╕Др╕гр╕Зр╕кр╕гр╣Йр╕▓р╕Зр╣Вр╕Ыр╕гр╣Ар╕Ир╕Д

```
chatbot-with-openai/
тФЬтФАтФА server.js              # Express server р╣Бр╕ер╕░ Line webhook
тФЬтФАтФА excelReader.js         # р╕нр╣Ир╕▓р╕Щр╣Бр╕ер╕░р╕Др╣Йр╕Щр╕лр╕▓р╕Вр╣Йр╕нр╕бр╕╣р╕е Excel
тФЬтФАтФА openaiClient.js        # OpenAI integration
тФЬтФАтФА item-asset.xlsx        # р╣Др╕Яр╕ер╣Мр╕Вр╣Йр╕нр╕бр╕╣р╕ер╕кр╕┤р╕Щр╕Др╣Йр╕▓
тФЬтФАтФА package.json
тФЬтФАтФА .env                   # Environment variables (р╣Др╕бр╣Ир╕нр╕▒р╕Ыр╣Вр╕лр╕ер╕Фр╣Гр╕Щ Git)
тФЬтФАтФА .env.example          # Template р╕кр╕│р╕лр╕гр╕▒р╕Ъ .env
тФФтФАтФА README.md
```

## ЁЯФР р╕Др╕зр╕▓р╕бр╕Ыр╕ер╕нр╕Фр╕ар╕▒р╕в

- р╣Др╕бр╣Ир╣Ар╕Ыр╕┤р╕Фр╣Ар╕Ьр╕в **р╕гр╕лр╕▒р╕кр╕ар╕▓р╕вр╣Гр╕Щ** (internal codes) р╕Вр╕нр╕Зр╕кр╕┤р╕Щр╕Др╣Йр╕▓
- р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕Др╕│р╕Цр╕▓р╕бр╣Бр╕ер╕░р╕Хр╕нр╕Ър╣Ар╕Йр╕Юр╕▓р╕░р╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щр╕гр╕░р╕Ър╕Ъ
- р╣Гр╕Кр╣Й environment variables р╕кр╕│р╕лр╕гр╕▒р╕Ъ sensitive data
- р╕Бр╕▓р╕гр╕Хр╕нр╕Ър╣Ар╕Йр╕Юр╕▓р╕░р╣Ар╕гр╕╖р╣Ир╕нр╕Зр╕Чр╕╡р╣Ир╣Ар╕Бр╕╡р╣Ир╕вр╕зр╕Вр╣Йр╕нр╕Зр╕Бр╕▒р╕Ър╕кр╕┤р╕Щр╕Др╣Йр╕▓

## ЁЯЪи р╕Бр╕▓р╕гр╣Бр╕Бр╣Йр╣Др╕Вр╕Ыр╕▒р╕Нр╕лр╕▓

### р╕Ыр╕▒р╕Нр╕лр╕▓р╕Чр╕╡р╣Ир╕Юр╕Ър╕Ър╣Ир╕нр╕в

1. **Webhook р╣Др╕бр╣Ир╕Чр╕│р╕Зр╕▓р╕Щ**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ URL р╣Бр╕ер╕░ SSL certificate
   - р╕Фр╕╣ logs р╣Гр╕Щр╕Др╕нр╕Щр╣Вр╕Лр╕е

2. **OpenAI р╣Др╕бр╣Ир╕Хр╕нр╕Ъ**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ API Key
   - р╕Фр╕╣ usage limits р╣Гр╕Щ OpenAI Dashboard

3. **р╕Вр╣Йр╕нр╕бр╕╣р╕е Excel р╣Др╕бр╣Ир╣Вр╕лр╕ер╕Ф**
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕зр╣Ир╕▓р╣Др╕Яр╕ер╣Мр╕нр╕вр╕╣р╣Ир╣Гр╕Щр╕Хр╕│р╣Бр╕лр╕Щр╣Ир╕Зр╕Чр╕╡р╣Ир╕Цр╕╣р╕Бр╕Хр╣Йр╕нр╕З
   - р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ър╕гр╕╣р╕Ыр╣Бр╕Ър╕Ър╕Вр╣Йр╕нр╕бр╕╣р╕ер╣Гр╕Щ Excel

### Logs р╣Бр╕ер╕░ Debugging

```bash
# р╕Фр╕╣ logs real-time
npm run dev

# р╕Хр╕гр╕зр╕Ир╕кр╕нр╕Ъ health
curl http://localhost:3000/health

# р╕Чр╕Фр╕кр╕нр╕Ър╕Бр╕▓р╕гр╕Др╣Йр╕Щр╕лр╕▓
curl http://localhost:3000/search/р╕Др╕Ур╕┤р╕Хр╕ир╕▓р╕кр╕Хр╕гр╣М
```

## ЁЯУЮ р╕Бр╕▓р╕гр╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╣Бр╕ер╕░р╕кр╕Щр╕▒р╕Ър╕кр╕Щр╕╕р╕Щ

р╕лр╕▓р╕Бр╕бр╕╡р╕Ыр╕▒р╕Нр╕лр╕▓р╕лр╕гр╕╖р╕нр╕Вр╣Йр╕нр╕кр╕Зр╕кр╕▒р╕в р╕Бр╕гр╕╕р╕Ур╕▓р╕Хр╕┤р╕Фр╕Хр╣Ир╕нр╕Чр╕╡р╕бр╕Юр╕▒р╕Тр╕Щр╕▓р╕гр╕░р╕Ър╕Ъ

---

**р╕кр╕гр╣Йр╕▓р╕Зр╕Фр╣Йр╕зр╕в тЭдя╕П р╕кр╕│р╕лр╕гр╕▒р╕Ър╕Юр╕Щр╕▒р╕Бр╕Зр╕▓р╕Щ Office р╕Чр╕╡р╣Ир╕Щр╣Ир╕▓р╕гр╕▒р╕Б**